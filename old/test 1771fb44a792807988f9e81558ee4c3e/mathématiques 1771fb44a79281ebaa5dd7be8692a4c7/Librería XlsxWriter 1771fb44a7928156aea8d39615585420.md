# Librería XlsxWriter

Date de création: January 10, 2025 11:44 AM
Modifié: January 10, 2025 11:44 AM

XlsxWriter es una librería para escribir en archivos de Excel.

```python
import xlsxwriter as xw
```

- **Abrir un archivo (en la misma ubicación del script .py)**. `xw.Workbook('archivo.xlsx')`.
    - **Nueva hoja**. Método `.add_worksheet()`.
    - **Agregar formato**. Método `.add_format({"bold"; "italic"; etc., True})` llamaría un formato. Ideal guardarlo en una variable.
        - El formato `num_format` añadiría un formato que se debe colocar en donde dice `True`.
    - Método `.write('celda', 'texto cualquiera', [formato])` escribiría en una celda. El formato debe ser llamado como en el método `.add_format()`.
    - Método `.close()` para cerrar las operaciones.

### Uso en conjunto con Pandas

- **Iniciar el writer.** `writer = pd.ExcelWriter("pandas_column_formats.xlsx", engine='xlsxwriter')`
- **Convertir los datos en un DataFrame interactuable.** El segundo arg. es el nombre de la hoja de destino. `df.to_excel(writer, sheet_name='Hoja1')`
- **Variables atajo para mayor facilidad.** Similar a lo de arriba.
    - `workbook = writer.book` . Con workbook se pueden usar todos los métodos de arriba.
    - `worksheet = writer.sheets['Hoja1']`
- **Fijar el tamaño y el formato de una columna.** (arg1 = rango de columnas, arg2: tamaño, arg3: variable con formato).
    - `worksheet.set_column('B:B', 18, format1)`
    - `worksheet.set_column('C:C', None, format2)`
- **Guardar todo.** `writer.save()`

[https://xlsxwriter.readthedocs.io/example_pandas_column_formats.html#ex-pandas-column-formats](https://xlsxwriter.readthedocs.io/example_pandas_column_formats.html#ex-pandas-column-formats)

[https://xlsxwriter.readthedocs.io/tutorial02.html](https://xlsxwriter.readthedocs.io/tutorial02.html)